<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Donor Sign Up Â· Crimson Shield</title>

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Plus Jakarta Sans', sans-serif;
}

body{
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: linear-gradient(135deg, #0b1219 0%, #151f2c 100%);
    color: #e2e8f0;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
}

.container{
    background: rgba(255,255,255,0.03);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(220,38,38,0.2);
    border-radius: 30px;
    padding: 3rem;
    width: 100%;
    max-width: 500px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.6);
}

.logo{
    text-align:center;
    margin-bottom:2rem;
    font-size:1.8rem;
    font-weight:800;
}

.logo span{
    color:#dc2626;
}

.subtitle{
    text-align:center;
    font-size:0.9rem;
    color:#94a3b8;
    margin-bottom:2rem;
}

form{
    display:flex;
    flex-direction:column;
    gap:1.2rem;
}

label{
    font-size:0.9rem;
    color:#94a3b8;
    margin-bottom:0.4rem;
    display:block;
}

input, select{
    width:100%;
    padding:1rem;
    border-radius:15px;
    border:1px solid rgba(220,38,38,0.2);
    background: rgba(0,0,0,0.3);
    color:white;
    font-size:0.95rem;
    outline:none;
}

input:focus, select:focus{
    border-color:#dc2626;
    box-shadow:0 0 0 2px rgba(220,38,38,0.3);
}

.row{
    display:flex;
    gap:1rem;
}

.row div{
    flex:1;
}

button{
    margin-top:1rem;
    padding:1rem;
    border-radius:40px;
    border:none;
    cursor:pointer;
    font-weight:600;
    font-size:1rem;
    background: linear-gradient(145deg, #dc2626, #b91c1c);
    color:white;
    box-shadow: 0 10px 25px rgba(220,38,38,0.4);
    transition:0.3s;
}

button:hover{
    transform: translateY(-2px);
    box-shadow: 0 15px 35px rgba(220,38,38,0.6);
}

.footer{
    margin-top:1.5rem;
    text-align:center;
    font-size:0.85rem;
    color:#94a3b8;
}

.footer a{
    color:#dc2626;
    text-decoration:none;
}
</style>
</head>

<body>

<div class="container">

    <div class="logo">
        Crimson<span>Shield</span>
    </div>

    <div class="subtitle">ðŸ©¸ Become a Life Saver Today</div>

    <form id="donorForm">

        <div>
            <label>Full Name</label>
            <input type="text" id="name" placeholder="Enter your full name" required>
        </div>
    
        <div class="row">
            <div>
                <label>Gender</label>
                <input type="text" id="gender" required>
            </div>
            <div>
                <label>Blood Group</label>
                <select id="blood_group" required>
                    <option value="">Select</option>
                    <option>A+</option>
                    <option>A-</option>
                    <option>B+</option>
                    <option>B-</option>
                    <option>O+</option>
                    <option>O-</option>
                    <option>AB+</option>
                    <option>AB-</option>
                </select>
            </div>
        </div>
    
        <div>
            <label>Phone Number</label>
            <input type="tel" id="phone" placeholder="Enter your phone number" required>
        </div>
    
        <div>
            <label>Email Address</label>
            <input type="email" id="email" placeholder="Enter your email" required>
        </div>
    
        <div>
            <label>Password</label>
            <input type="password" id="password" placeholder="Create password" required>
        </div>
    
        <button type="submit">Register as Donor</button>
    
    </form>
    <div class="footer">
        Already registered? <a href="user-login.html">Login</a>
    </div>

</div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>

const supabaseUrl = "https://lkflnzxcbwlmxounerex.supabase.co";
const supabaseKey = "sb_publishable_SqucPk5SOnBhLL6goXwxIQ_jDVlIy3x";

const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

console.log("Supabase Client Created");


// ðŸ”´ ADD THE SIGNUP LOGIC HERE
document.getElementById("donorForm").addEventListener("submit", async function(e) {

    e.preventDefault();

    const name = document.getElementById("name").value;
    const gender = document.getElementById("gender").value;
    const blood_group = document.getElementById("blood_group").value;
    const phone = document.getElementById("phone").value;
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    const { data: authData, error: authError } = await supabaseClient.auth.signUp({
        email: email,
        password: password
    });

    if (authError) {
        alert("Signup Error: " + authError.message);
        return;
    }

    // Get Live Location and Insert Donor
navigator.geolocation.getCurrentPosition(async function(position) {

    const latitude = position.coords.latitude;
    const longitude = position.coords.longitude;

    const { error: insertError } = await supabaseClient
        .from("donors")
        .insert([
            {
                user_id: authData.user.id,
                name: name,
                phone: phone,
                blood_group: blood_group,
                latitude: latitude,
                longitude: longitude,
                is_available: true
            }
        ]);

    if (insertError) {
        alert("Insert Error: " + insertError.message);
        return;
    }

    alert("Donor registered with location!");
});

    alert("Donor registered successfully!");

});

</script>

</body>
</html>